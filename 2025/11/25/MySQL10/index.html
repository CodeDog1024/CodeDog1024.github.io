<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MySQL 视图/存储过程/触发器 | 代码狗的小屋</title><meta name="author" content="Code Dog"><meta name="copyright" content="Code Dog"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="视图视图介绍视图（View）是一种虚拟存在的表，它是基于 SQL 查询结果集创建的。视图本身不存储数据，而是动态地从基础表中获取数据。视图可以简化复杂的查询，提高数据的安全性，并提供数据的抽象层。 视图基本使用 创建视图  CREATE [OR REPLACE] VIEW 视图名 AS 查询语句 [WITH [CASCADED | LOCAL] CHECK OPTION];   查看全部视图  S">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 视图&#x2F;存储过程&#x2F;触发器">
<meta property="og:url" content="https://codedog1024.github.io/2025/11/25/MySQL10/index.html">
<meta property="og:site_name" content="代码狗的小屋">
<meta property="og:description" content="视图视图介绍视图（View）是一种虚拟存在的表，它是基于 SQL 查询结果集创建的。视图本身不存储数据，而是动态地从基础表中获取数据。视图可以简化复杂的查询，提高数据的安全性，并提供数据的抽象层。 视图基本使用 创建视图  CREATE [OR REPLACE] VIEW 视图名 AS 查询语句 [WITH [CASCADED | LOCAL] CHECK OPTION];   查看全部视图  S">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://codedog1024.github.io/img/13.jpg">
<meta property="article:published_time" content="2025-11-25T14:32:08.000Z">
<meta property="article:modified_time" content="2025-12-08T12:13:26.438Z">
<meta property="article:author" content="Code Dog">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://codedog1024.github.io/img/13.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MySQL 视图/存储过程/触发器",
  "url": "https://codedog1024.github.io/2025/11/25/MySQL10/",
  "image": "https://codedog1024.github.io/img/13.jpg",
  "datePublished": "2025-11-25T14:32:08.000Z",
  "dateModified": "2025-12-08T12:13:26.438Z",
  "author": [
    {
      "@type": "Person",
      "name": "Code Dog",
      "url": "https://codedog1024.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://codedog1024.github.io/2025/11/25/MySQL10/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const hour = new Date().getHours()
          const isNight = hour <= 6 || hour >= 1
          if (theme === undefined) isNight ? activateDarkMode() : activateLightMode()
          else theme === 'light' ? activateLightMode() : activateDarkMode()
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL 视图/存储过程/触发器',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/13.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">代码狗的小屋</span></a><a class="nav-page-title" href="/"><span class="site-name">MySQL 视图/存储过程/触发器</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">MySQL 视图/存储过程/触发器</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-11-25T14:32:08.000Z" title="发表于 2025-11-25 22:32:08">2025-11-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-12-08T12:13:26.438Z" title="更新于 2025-12-08 20:13:26">2025-12-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><h3 id="视图介绍"><a href="#视图介绍" class="headerlink" title="视图介绍"></a>视图介绍</h3><p>视图（View）是一种虚拟存在的表，它是基于 SQL 查询结果集创建的。视图本身不存储数据，而是动态地从基础表中获取数据。视图可以简化复杂的查询，提高数据的安全性，并提供数据的抽象层。</p>
<h3 id="视图基本使用"><a href="#视图基本使用" class="headerlink" title="视图基本使用"></a>视图基本使用</h3><ol>
<li><p>创建视图</p>
<blockquote>
<p>CREATE [OR REPLACE] VIEW 视图名 AS 查询语句 [WITH [CASCADED | LOCAL] CHECK OPTION];</p>
</blockquote>
</li>
<li><p>查看全部视图</p>
<blockquote>
<p>SHOW FULL TABLES WHERE Table_type &#x3D; ‘VIEW’;</p>
</blockquote>
</li>
<li><p>查看指定视图的定义</p>
<blockquote>
<p>SHOW CREATE VIEW 视图名;</p>
</blockquote>
</li>
<li><p>查看视图数据</p>
<blockquote>
<p>SELECT * FROM 视图名;</p>
</blockquote>
</li>
<li><p>修改视图</p>
<blockquote>
<p>CREATE OR REPLACE VIEW 视图名 AS 新的查询语句 [WITH [CASCADED | LOCAL] CHECK OPTION];</p>
</blockquote>
<blockquote>
<p>ALTER VIEW 视图名 AS 新的查询语句 [WITH [CASCADED | LOCAL] CHECK OPTION];</p>
</blockquote>
</li>
<li><p>删除视图</p>
<blockquote>
<p>DROP VIEW [IF EXISTS] 视图名;</p>
</blockquote>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建视图</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> user_view_1 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> tb_user</span><br><span class="line"><span class="keyword">WHERE</span> profession <span class="operator">=</span> <span class="string">&#x27;软件工程&#x27;</span></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">LOCAL</span> <span class="keyword">CHECK</span> OPTION;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看全部视图</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> TABLES <span class="keyword">WHERE</span> Table_type <span class="operator">=</span> <span class="string">&#x27;VIEW&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看指定视图</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> user_view_1;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看视图数据</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> user_view_1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> user_view_1</span><br><span class="line"><span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">23</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改视图，相当于用新的视图覆盖原视图</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> user_view_1 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> tb_user</span><br><span class="line"><span class="keyword">WHERE</span> profession <span class="operator">=</span> <span class="string">&#x27;城市规划&#x27;</span></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">LOCAL</span> <span class="keyword">CHECK</span> OPTION;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改原视图</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> user_view_1 <span class="keyword">AS</span> <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">                          <span class="keyword">FROM</span> tb_user</span><br><span class="line">                          <span class="keyword">WHERE</span> profession <span class="operator">=</span> <span class="string">&#x27;化工&#x27;</span> <span class="keyword">WITH</span> <span class="keyword">LOCAL</span> <span class="keyword">CHECK</span> OPTION;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除视图</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> IF <span class="keyword">EXISTS</span> user_view_1;</span><br></pre></td></tr></table></figure>

<h3 id="检查选项"><a href="#检查选项" class="headerlink" title="检查选项"></a>检查选项</h3><p>在操作视图中的数据时，其实就是在操作视图所对应的表。当向视图中插入或更新数据时，MySQL 会根据视图的定义来检查数据是否符合视图的查询条件。为了控制这种检查行为，可以在创建视图时使用 <code>WITH [CASCADED | LOCAL] CHECK OPTION</code>。</p>
<ol>
<li>如果创建视图时没有使用<code>WITH [CASCADED | LOCAL] CHECK OPTION</code>，那么可以插入任何数据到基础表中，但是只有满足视图定义的查询条件时，数据才会添加到视图中。若该视图是基于其他视图创建的，除非上层视图开启了<code>CHECK CASCADED OPTION</code>，否则不需要满足上层视图的查询条件。</li>
<li>如果创建视图时使用了<code>WITH CASCADED CHECK OPTION</code>，那么插入的数据必须满足当前视图定义的查询条件，若当前视图是基于其他视图创建的，尽管其他视图没有开启<code>CHECK OPTION</code>，也需要满足上层视图的查询条件。</li>
<li>如果创建视图时使用了<code>WITH LOCAL CHECK OPTION</code>，那么插入的数据必须满足当前视图定义的查询条件，若当前视图是基于其他视图创建的，且其他视图也开启了<code>CHECK OPTION</code>，则也需要满足上层视图的查询条件。</li>
</ol>
<p>未开启 <code>WITH [CASCADED | LOCAL] CHECK OPTION</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建视图</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> user_view_1 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> tb_user</span><br><span class="line"><span class="keyword">WHERE</span> profession <span class="operator">=</span> <span class="string">&#x27;软件工程&#x27;</span>; </span><br><span class="line"> </span><br><span class="line"><span class="comment">-- 查看视图数据</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> user_view_1;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 向视图中插入数据，实际是插入到表中</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> user_view_1(id, name, phone, email, profession, age, gender, status, create_time)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">25</span>, <span class="string">&#x27;诸葛亮&#x27;</span>, <span class="number">17799990024</span>, <span class="string">&#x27;zhuge666@sina.com&#x27;</span>, <span class="string">&#x27;软件工程&#x27;</span>, <span class="number">22</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;2025-11-26 19:32:30&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入成功，但是只添加到了 tb_user 中，在视图 user_view_1 中不存在，因为在创建视图时指定了条件 profession = &#x27;软件工程&#x27;</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> user_view_1(id, name, phone, email, profession, age, gender, status, create_time)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">26</span>, <span class="string">&#x27;哪吒&#x27;</span>, <span class="number">17799990025</span>, <span class="string">&#x27;nezha666@sina.com&#x27;</span>, <span class="string">&#x27;计算机科学&#x27;</span>, <span class="number">22</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;2025-11-26 19:32:30&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>开启 <code>WITH [CASCADED | LOCAL] CHECK OPTION</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建视图</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> user_view_1 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> tb_user</span><br><span class="line"><span class="keyword">WHERE</span> profession <span class="operator">=</span> <span class="string">&#x27;软件工程&#x27;</span></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">LOCAL</span> <span class="keyword">CHECK</span> OPTION ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看视图数据</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> user_view_1;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 向视图中插入数据，实际是插入到表中，并且满足视图的条件，同时插入到视图中</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> user_view_1(id, name, phone, email, profession, age, gender, status, create_time)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">25</span>, <span class="string">&#x27;诸葛亮&#x27;</span>, <span class="number">17799990024</span>, <span class="string">&#x27;zhuge666@sina.com&#x27;</span>, <span class="string">&#x27;软件工程&#x27;</span>, <span class="number">22</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;2025-11-26 19:32:30&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入失败，因为开启了 WITH LOCAL CHECK OPTION，因为在创建视图时指定了条件 profession = &#x27;软件工程&#x27;</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> user_view_1(id, name, phone, email, profession, age, gender, status, create_time)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">26</span>, <span class="string">&#x27;哪吒&#x27;</span>, <span class="number">17799990025</span>, <span class="string">&#x27;nezha666@sina.com&#x27;</span>, <span class="string">&#x27;计算机科学&#x27;</span>, <span class="number">22</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;2025-11-26 19:32:30&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 报错：[HY000][1369] CHECK OPTION failed &#x27;mysql_study.user_view_1&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="更新及作用"><a href="#更新及作用" class="headerlink" title="更新及作用"></a>更新及作用</h3><p>当我们在更新视图时，该视图必须满足：视图的结构必须与基础表的结构一致，且视图中不能包含聚合函数、DISTINCT 关键字、GROUP BY 子句、HAVING 子句或子查询等复杂查询。</p>
<ol>
<li>简单：用户可以将常用的查询语句封装成视图，简化查询操作。</li>
<li>安全：MySQL 中通过授权只能限制用户访问表，而不能限制用户访问表中的某列，通过将表中的可见列封装成视图，然后再访问视图，这样子用户只能看到可见列，从而提高数据的安全性。</li>
<li>独立：视图中的数据虽然是从基础表中查询的，但是当基础表的结构发生变化时，只需要更新视图结构即可。</li>
</ol>
<h3 id="视图案例"><a href="#视图案例" class="headerlink" title="视图案例"></a>视图案例</h3><p>为保证数据安全，用户在访问 tb_user 表时，只能看到基本字段，不能看到 phone 和 email 字段。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> tb_user_view <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> id, name, profession, age, gender, status, create_time</span><br><span class="line"><span class="keyword">FROM</span> tb_user;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tb_user_view;</span><br><span class="line"><span class="comment">-- 1,吕布,软件工程,23,1,6,2001-02-02 00:00:00</span></span><br><span class="line"><span class="comment">-- 2,曹操,通讯工程,33,1,0,2001-03-05 00:00:00</span></span><br><span class="line"><span class="comment">-- 3,赵云,英语,34,1,2,2002-03-02 00:00:00</span></span><br><span class="line"><span class="comment">-- 4,孙悟空,工程造价,54,1,0,2001-07-02 00:00:00</span></span><br><span class="line"><span class="comment">-- 5,花木兰,软件工程,23,2,1,2001-04-22 00:00:00</span></span><br><span class="line"><span class="comment">-- 6,大桥,舞蹈,22,2,0,2001-02-07 00:00:00</span></span><br><span class="line"><span class="comment">-- 7,露娜,应用数学,24,2,0,2001-02-08 00:00:00</span></span><br><span class="line"><span class="comment">-- 8,程咬金,化工,38,1,5,2001-05-23 00:00:00</span></span><br><span class="line"><span class="comment">-- 9,项羽,金属材料,43,1,0,2001-09-18 00:00:00</span></span><br><span class="line"><span class="comment">-- 10,白起,机械工程及其自动化,27,1,2,2001-08-16 00:00:00</span></span><br><span class="line"><span class="comment">-- 11,韩信,无机非金属材料工程,27,1,0,2001-06-12 00:00:00</span></span><br><span class="line"><span class="comment">-- 12,荆轲,会计,29,1,0,2001-05-11 00:00:00</span></span><br><span class="line"><span class="comment">-- 13,兰陵王,工程造价,44,1,1,2001-04-09 00:00:00</span></span><br><span class="line"><span class="comment">-- 14,狂铁,应用数学,43,1,2,2001-04-10 00:00:00</span></span><br><span class="line"><span class="comment">-- 15,貂蝉,软件工程,40,2,3,2001-02-12 00:00:00</span></span><br><span class="line"><span class="comment">-- 16,妲己,软件工程,31,2,0,2001-01-30 00:00:00</span></span><br><span class="line"><span class="comment">-- 17,芈月,工业经济,35,2,0,2000-05-03 00:00:00</span></span><br><span class="line"><span class="comment">-- 18,嬴政,化工,38,1,1,2001-08-08 00:00:00</span></span><br><span class="line"><span class="comment">-- 19,狄仁杰,国际贸易,30,1,0,2007-03-12 00:00:00</span></span><br><span class="line"><span class="comment">-- 20,安琪拉,城市规划,51,2,0,2001-08-15 00:00:00</span></span><br><span class="line"><span class="comment">-- 21,典韦,城市规划,52,1,2,2000-04-12 00:00:00</span></span><br><span class="line"><span class="comment">-- 22,廉颇,土木工程,19,1,3,2002-07-18 00:00:00</span></span><br><span class="line"><span class="comment">-- 23,后裔,城市园林,20,1,0,2002-03-10 00:00:00</span></span><br><span class="line"><span class="comment">-- 24,姜子牙,工程造价,29,1,4,2003-05-26 00:00:00</span></span><br><span class="line"><span class="comment">-- 25,诸葛亮,软件工程,22,2,0,2025-11-26 19:32:30</span></span><br></pre></td></tr></table></figure>

<h2 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h2><h3 id="存储过程介绍"><a href="#存储过程介绍" class="headerlink" title="存储过程介绍"></a>存储过程介绍</h3><p>存储过程是一个由多条 SQL 语句组成的集合，通过事先在数据库中创建存储过程，然后调用存储过程来执行 SQL 语句，从而简化复杂的操作，提高数据库的性能。</p>
<h3 id="存储过程特点"><a href="#存储过程特点" class="headerlink" title="存储过程特点"></a>存储过程特点</h3><ol>
<li>封装、复用</li>
<li>可以接收参数、并返回结果</li>
<li>减少交互次数，提升效率</li>
</ol>
<h3 id="存储过程基本使用"><a href="#存储过程基本使用" class="headerlink" title="存储过程基本使用"></a>存储过程基本使用</h3><ol>
<li><p>创建存储过程</p>
<blockquote>
<p>CREATE PROCEDURE 存储过程名 ([参数列表]) BEGIN SQL语句; END;</p>
</blockquote>
</li>
<li><p>调用存储过程</p>
<blockquote>
<p>CALL 存储过程名([参数列表]);</p>
</blockquote>
</li>
<li><p>查看存储过程</p>
<blockquote>
<p>SELECT * FROM INFORMATION_SCHEMA.ROUTINES WHERE ROUTINE_TYPE &#x3D; ‘PROCEDURE’;</p>
</blockquote>
</li>
<li><p>删除存储过程</p>
<blockquote>
<p>DROP PROCEDURE 存储过程名;</p>
</blockquote>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建存储过程</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p1()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(tb_user.id) <span class="keyword">FROM</span> tb_user;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用存储过程</span></span><br><span class="line"><span class="keyword">CALL</span> p1();</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看全部存储过程</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> INFORMATION_SCHEMA.ROUTINES</span><br><span class="line"><span class="keyword">WHERE</span> ROUTINE_TYPE <span class="operator">=</span> <span class="string">&#x27;PROCEDURE&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> ROUTINE_SCHEMA <span class="operator">=</span> <span class="string">&#x27;mysql_study&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p1;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除存储过程 </span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> IF <span class="keyword">EXISTS</span> p1;</span><br></pre></td></tr></table></figure>

<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>在存储过程中，可以使用变量来存储数据，并使用变量来返回结果。变量共分为三类，分别是：<code>系统变量</code>、<code>用户变量</code>和<code>局部变量</code>。</p>
<h3 id="系统变量"><a href="#系统变量" class="headerlink" title="系统变量"></a>系统变量</h3><p>系统变量是 MySQL 提供的变量，用于保存 MySQL 服务器的状态信息，如当前时间、当前用户、当前数据库等，属于服务器层面，系统变量又分为<code>全局变量(GLOBAL)</code>和<code>会话变量(SESSION)</code>两种。</p>
<ol>
<li><p>查看系统变量</p>
<blockquote>
<p>SHOW [GLOBAL | SESSION] VARIABLES [LIKE ‘变量名’];</p>
</blockquote>
<blockquote>
<p>SELECT @@[GLOBAL | SESSION] 变量名;</p>
</blockquote>
</li>
<li><p>修改系统变量</p>
<blockquote>
<p>SET [@@][GLOBAL | SESSION] 变量名 &#x3D; 值;</p>
</blockquote>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看全部系统变量，默认是 SESSION 级别</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看全局系统变量</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> VARIABLES;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用模糊查询</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;auto%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看指定系统变量</span></span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@global</span>.autocommit;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置系统变量</span></span><br><span class="line"><span class="keyword">SET</span> SESSION AUTOCOMMIT <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@session</span>.autocommit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> @<span class="variable">@session</span>.autocommit <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h3 id="用户变量"><a href="#用户变量" class="headerlink" title="用户变量"></a>用户变量</h3><p>用户变量是存储在客户端的变量，用于保存临时数据，属于用户层面。 用户变量以 <code>@</code> 符号开头，可以在 SQL 语句中使用。</p>
<ol>
<li><p>创建用户变量</p>
<blockquote>
<p>SET @变量名 :&#x3D; 值;</p>
</blockquote>
<blockquote>
<p>SELECT 字段名 INTO @变量名 FROM 表名 WHERE 条件;</p>
</blockquote>
</li>
<li><p>使用用户变量</p>
<blockquote>
<p>SELECT @变量名;</p>
</blockquote>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建用户变量</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@my_name</span> <span class="operator">=</span> <span class="string">&#x27;code dog&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@my_age</span> :<span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@my_gender</span> :<span class="operator">=</span> <span class="string">&#x27;男&#x27;</span>, <span class="variable">@my_hobby</span> :<span class="operator">=</span> <span class="string">&#x27;Java&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用 SELECT 赋值</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@my_profession</span> :<span class="operator">=</span> <span class="string">&#x27;软件工程&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(tb_user.id) <span class="keyword">INTO</span> <span class="variable">@tb_user_count</span> <span class="keyword">FROM</span> tb_user;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看用户变量</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@my_name</span>, <span class="variable">@my_age</span>, <span class="variable">@my_gender</span>, <span class="variable">@my_hobby</span>, <span class="variable">@my_profession</span>, <span class="variable">@tb_user_count</span>;</span><br></pre></td></tr></table></figure>

<h3 id="局部变量"><a href="#局部变量" class="headerlink" title="局部变量"></a>局部变量</h3><p>局部变量是存储在存储过程中定义的变量，属于存储过程内部。 局部变量以 <code>DECLARE</code> 关键字定义，只能在存储过程中使用。格式为：<code>DECLARE 变量名 数据类型 [DEFAULT 值];</code></p>
<ol>
<li><p>定义局部变量</p>
<blockquote>
<p>DECLARE 变量名 数据类型 [DEFAULT 值];</p>
</blockquote>
</li>
<li><p>赋值</p>
<blockquote>
<p>SET 变量名 :&#x3D; 值;</p>
</blockquote>
<blockquote>
<p>SELECT 字段名 INTO 变量名 FROM 表名 WHERE 条件;</p>
</blockquote>
</li>
<li><p>使用局部变量</p>
<blockquote>
<p>SELECT 变量名;</p>
</blockquote>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p2()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> user_count <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">SET</span> user_count :<span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">SELECT</span> user_count;</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(tb_user.id) <span class="keyword">INTO</span> user_count <span class="keyword">FROM</span> tb_user;</span><br><span class="line">    <span class="keyword">SELECT</span> user_count;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> p2();</span><br></pre></td></tr></table></figure>

<h3 id="IF"><a href="#IF" class="headerlink" title="IF"></a>IF</h3><p>IF 语句用于判断某个条件，并执行相应的语句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">IF 条件<span class="number">1</span> <span class="keyword">THEN</span></span><br><span class="line">    语句<span class="number">1</span>;</span><br><span class="line">[ELSEIF 条件<span class="number">2</span> <span class="keyword">THEN</span>]</span><br><span class="line">    语句<span class="number">2</span>;</span><br><span class="line">[ELSEIF 条件<span class="number">3</span> <span class="keyword">THEN</span>]</span><br><span class="line">    语句<span class="number">3</span>;</span><br><span class="line">......</span><br><span class="line">[<span class="keyword">ELSE</span>]</span><br><span class="line">    语句n;</span><br><span class="line"><span class="keyword">END</span> IF;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p3()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> score <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">58</span>;</span><br><span class="line">    <span class="keyword">DECLARE</span> level <span class="type">VARCHAR</span>(<span class="number">10</span>);</span><br><span class="line">    IF score <span class="operator">&gt;=</span> <span class="number">85</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">SET</span> level :<span class="operator">=</span> <span class="string">&#x27;优秀&#x27;</span>;</span><br><span class="line">    ELSEIF score <span class="operator">&gt;=</span> <span class="number">60</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">SET</span> level :<span class="operator">=</span> <span class="string">&#x27;合格&#x27;</span>;</span><br><span class="line">    <span class="keyword">ELSE</span></span><br><span class="line">        <span class="keyword">SET</span> level :<span class="operator">=</span> <span class="string">&#x27;不合格&#x27;</span>;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">SELECT</span> level;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> p3();</span><br></pre></td></tr></table></figure>

<h3 id="存储过程传参"><a href="#存储过程传参" class="headerlink" title="存储过程传参"></a>存储过程传参</h3><table>
<thead>
<tr>
<th>参数类型</th>
<th>参数方向</th>
</tr>
</thead>
<tbody><tr>
<td>IN</td>
<td>输入参数</td>
</tr>
<tr>
<td>OUT</td>
<td>输出参数</td>
</tr>
<tr>
<td>INOUT</td>
<td>输入输出参数</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建存储过程</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p4(<span class="keyword">IN</span> score <span class="type">INT</span>, <span class="keyword">OUT</span> level <span class="type">VARCHAR</span>(<span class="number">10</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    IF score <span class="operator">&gt;=</span> <span class="number">85</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">SET</span> level :<span class="operator">=</span> <span class="string">&#x27;优秀&#x27;</span>;</span><br><span class="line">    ELSEIF score <span class="operator">&gt;=</span> <span class="number">60</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">SET</span> level :<span class="operator">=</span> <span class="string">&#x27;合格&#x27;</span>;</span><br><span class="line">    <span class="keyword">ELSE</span></span><br><span class="line">        <span class="keyword">SET</span> level :<span class="operator">=</span> <span class="string">&#x27;不合格&#x27;</span>;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用存储过程，并传递参数，然后将返回结果放入 @level 中</span></span><br><span class="line"><span class="keyword">CALL</span> p4(<span class="number">60</span>, <span class="variable">@level</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看 @level</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@level</span>;</span><br></pre></td></tr></table></figure>

<h3 id="CASE"><a href="#CASE" class="headerlink" title="CASE"></a>CASE</h3><p>CASE 语句用于判断某个条件，并执行相应的语句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CASE</span> <span class="keyword">value</span></span><br><span class="line"><span class="keyword">WHEN</span> 值<span class="number">1</span> <span class="keyword">THEN</span> 语句<span class="number">1</span>;</span><br><span class="line"><span class="keyword">WHEN</span> 值<span class="number">2</span> <span class="keyword">THEN</span> 语句<span class="number">2</span>;</span><br><span class="line"><span class="keyword">WHEN</span> 值<span class="number">3</span> <span class="keyword">THEN</span> 语句<span class="number">3</span>;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">WHEN</span> 值n <span class="keyword">THEN</span> 语句n;</span><br><span class="line"><span class="keyword">ELSE</span> 语句n<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> 表达式<span class="number">1</span> <span class="keyword">THEN</span> 语句<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">WHEN</span> 表达式<span class="number">2</span> <span class="keyword">THEN</span> 语句<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">WHEN</span> 表达式<span class="number">3</span> <span class="keyword">THEN</span> 语句<span class="number">3</span>;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">WHEN</span> 表达式n <span class="keyword">THEN</span> 语句n;</span><br><span class="line">    <span class="keyword">ELSE</span> 语句n<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p5(<span class="keyword">IN</span> <span class="keyword">month</span> <span class="type">INT</span>, <span class="keyword">OUT</span> season <span class="type">VARCHAR</span>(<span class="number">10</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">CASE</span> <span class="keyword">month</span></span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第一季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">2</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第一季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">3</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第一季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">4</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第二季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">5</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第二季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">6</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第二季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">7</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第三季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">8</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第三季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">9</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第三季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">10</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第四季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">11</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第四季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">12</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="string">&#x27;第四季度&#x27;</span>;</span><br><span class="line">        <span class="keyword">ELSE</span> <span class="keyword">SET</span> season <span class="operator">=</span> <span class="keyword">NULL</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> p5(<span class="number">1</span>, <span class="variable">@season</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@season</span>;</span><br></pre></td></tr></table></figure>

<h3 id="WHILE"><a href="#WHILE" class="headerlink" title="WHILE"></a>WHILE</h3><p>WHILE 循环用于重复执行一段代码，直到条件为假。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WHILE 条件 DO</span><br><span class="line">    语句;</span><br><span class="line"><span class="keyword">END</span> WHILE;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p6(<span class="keyword">IN</span> num <span class="type">INT</span>, <span class="keyword">OUT</span> res <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SET</span> res :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    WHILE num <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">        DO</span><br><span class="line">            <span class="keyword">SET</span> res :<span class="operator">=</span> res <span class="operator">+</span> num;</span><br><span class="line">            <span class="keyword">SET</span> num :<span class="operator">=</span> num <span class="operator">-</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">END</span> WHILE;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> p6(<span class="number">100</span>, <span class="variable">@res</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@res</span>;</span><br></pre></td></tr></table></figure>

<h3 id="REPEAT"><a href="#REPEAT" class="headerlink" title="REPEAT"></a>REPEAT</h3><p>REPEAT 循环用于重复执行一段代码，直到条件为真。但是 REPEAT 循环至少会执行一次。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">REPEAT</span><br><span class="line">    语句;</span><br><span class="line">    UNTIL 条件</span><br><span class="line">    <span class="keyword">END</span> REPEAT;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p7(<span class="keyword">IN</span> num <span class="type">INT</span>, <span class="keyword">OUT</span> res <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SET</span> res :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    REPEAT</span><br><span class="line">        <span class="keyword">SET</span> res :<span class="operator">=</span> res <span class="operator">+</span> num;</span><br><span class="line">        <span class="keyword">SET</span> num :<span class="operator">=</span> num <span class="operator">-</span> <span class="number">1</span>;</span><br><span class="line">    UNTIL num <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">END</span> REPEAT;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> p7(<span class="number">10</span>, <span class="variable">@res</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@res</span>;</span><br></pre></td></tr></table></figure>

<h3 id="LOOP"><a href="#LOOP" class="headerlink" title="LOOP"></a>LOOP</h3><p>LOOP 循环用于重复执行一段代码，直到条件为假。但是 LOOP 必须配合 <code>LEAVE</code> 和 <code>ITERATE</code> 使用。</p>
<ol>
<li><code>LEAVE</code> 用于退出循环。</li>
<li><code>ITERATE</code> 用于跳过当前循环，继续下一次循环。</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[label:] LOOP</span><br><span class="line">    语句;</span><br><span class="line">    [LEAVE label;] <span class="comment">-- 退出循环</span></span><br><span class="line">    [ITERATE label;] <span class="comment">-- 跳过当前循环，继续下下一个循环</span></span><br><span class="line"><span class="keyword">END</span> LOOP [label];</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p8(<span class="keyword">IN</span> num <span class="type">INT</span>, <span class="keyword">OUT</span> res <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SET</span> res :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    loop_sum:</span><br><span class="line">    LOOP</span><br><span class="line">        IF num <span class="operator">&lt;=</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">            LEAVE loop_sum;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line"></span><br><span class="line">        IF <span class="built_in">MOD</span>(num, <span class="number">2</span>) <span class="operator">&lt;&gt;</span> <span class="number">1</span> <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">SET</span> num <span class="operator">=</span> num <span class="operator">-</span> <span class="number">1</span>;</span><br><span class="line">            ITERATE loop_sum;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">SET</span> res <span class="operator">=</span> res <span class="operator">+</span> num;</span><br><span class="line">        <span class="keyword">SET</span> num <span class="operator">=</span> num <span class="operator">-</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> LOOP loop_sum;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> p8(<span class="number">100</span>, <span class="variable">@res</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@res</span>;</span><br></pre></td></tr></table></figure>

<h3 id="CURSOR"><a href="#CURSOR" class="headerlink" title="CURSOR"></a>CURSOR</h3><p>当变量需要存储多个结果时，原有的数据类型无法满足要求，此时可以使用 CURSOR，CURSOR 可以存储、访问多个结果。</p>
<ol>
<li><p>创建 CURSOR</p>
<blockquote>
<p>DECLARE 游标名 CURSOR FOR 查询语句;</p>
</blockquote>
</li>
<li><p>打开 CURSOR</p>
<blockquote>
<p>OPEN 游标名;</p>
</blockquote>
</li>
<li><p>获取 CURSOR 的结果</p>
<blockquote>
<p>FETCH 游标名 INTO 变量;</p>
</blockquote>
</li>
<li><p>关闭 CURSOR</p>
<blockquote>
<p>CLOSE 游标名;</p>
</blockquote>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p1(<span class="keyword">IN</span> user_age <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> user_name <span class="type">VARCHAR</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> user_profession <span class="type">VARCHAR</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> user_cursor <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">SELECT</span> tb_user.name, tb_user.profession <span class="keyword">FROM</span> tb_user <span class="keyword">WHERE</span> age <span class="operator">&lt;=</span> user_age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> tb_user_profession;</span><br><span class="line">    <span class="keyword">CREATE TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> tb_user_profession</span><br><span class="line">    (</span><br><span class="line">        id         <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY KEY</span> COMMENT <span class="string">&#x27;ID&#x27;</span>,</span><br><span class="line">        name       <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">UNIQUE</span> COMMENT <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">        profession <span class="type">VARCHAR</span>(<span class="number">10</span>) COMMENT <span class="string">&#x27;专业&#x27;</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">OPEN</span> user_cursor;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- TODO 这里是死循环，需要用到 条件处理 的知识</span></span><br><span class="line">    WHILE <span class="literal">TRUE</span></span><br><span class="line">        DO</span><br><span class="line">            <span class="keyword">FETCH</span> user_cursor <span class="keyword">INTO</span> user_name, user_profession;</span><br><span class="line">            <span class="keyword">INSERT INTO</span> tb_user_profession(name, profession) <span class="keyword">VALUES</span> (user_name, user_profession);</span><br><span class="line">        <span class="keyword">END</span> WHILE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLOSE</span> user_cursor;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> p1(<span class="number">25</span>);</span><br></pre></td></tr></table></figure>

<h3 id="条件处理"><a href="#条件处理" class="headerlink" title="条件处理"></a>条件处理</h3><p>条件处理程序用于在 SQL 语句运行时，当 SQL 语句成功或者失败时，根据运行结果执行不同的操作。类似于 Java 的 try-catch-finally 语句。</p>
<ol>
<li><p>创建条件处理程序</p>
<blockquote>
<p>DECLARE 处理 HANDLER FOR 错误码 处理程序;</p>
</blockquote>
</li>
<li><p>处理：</p>
<ul>
<li>CONTINUE: 继续执行 SQL 语句，并忽略错误。</li>
<li>EXIT: 退出 SQL 语句，并忽略错误。</li>
</ul>
</li>
<li><p>错误码: 错误码列表，多个错误码用逗号隔开。</p>
<ul>
<li>SQLSTATE 状态码：当错误码为指定状态码时，执行处理程序。</li>
<li>SQLWARNING：当错误码为类型时，执行处理程序。</li>
<li>NOT FOUND：当错误码为类型时，执行处理程序。</li>
<li>SQLEXCEPTION：当错误码为类型时，执行处理程序。</li>
</ul>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p1(<span class="keyword">IN</span> user_age <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> user_name <span class="type">VARCHAR</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> user_profession <span class="type">VARCHAR</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> user_cursor <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">SELECT</span> tb_user.name, tb_user.profession <span class="keyword">FROM</span> tb_user <span class="keyword">WHERE</span> age <span class="operator">&lt;=</span> user_age;</span><br><span class="line">    <span class="comment">-- 错误码为02000时，执行处理程序，退出 SQL 语句并关闭 CURSOR</span></span><br><span class="line">    <span class="keyword">DECLARE</span> EXIT HANDLER <span class="keyword">FOR</span> <span class="keyword">SQLSTATE</span> <span class="string">&#x27;02000&#x27;</span> <span class="keyword">CLOSE</span> user_cursor;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> tb_user_profession;</span><br><span class="line">    <span class="keyword">CREATE TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> tb_user_profession</span><br><span class="line">    (</span><br><span class="line">        id         <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY KEY</span> COMMENT <span class="string">&#x27;ID&#x27;</span>,</span><br><span class="line">        name       <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">UNIQUE</span> COMMENT <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">        profession <span class="type">VARCHAR</span>(<span class="number">10</span>) COMMENT <span class="string">&#x27;专业&#x27;</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">OPEN</span> user_cursor;</span><br><span class="line"></span><br><span class="line">    WHILE <span class="literal">TRUE</span></span><br><span class="line">        DO</span><br><span class="line">            <span class="keyword">FETCH</span> user_cursor <span class="keyword">INTO</span> user_name, user_profession;</span><br><span class="line">            <span class="keyword">INSERT INTO</span> tb_user_profession(name, profession) <span class="keyword">VALUES</span> (user_name, user_profession);</span><br><span class="line">        <span class="keyword">END</span> WHILE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLOSE</span> user_cursor;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> p1(<span class="number">25</span>);</span><br></pre></td></tr></table></figure>

<h2 id="存储函数"><a href="#存储函数" class="headerlink" title="存储函数"></a>存储函数</h2><p>存储函数和存储过程类似，但是存储函数返回一个值，且存储函数只能有输入参数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> 存储函数名(参数列表) <span class="keyword">RETURNS</span> 返回值数据类型 [<span class="keyword">DETERMINISTIC</span> <span class="operator">|</span> <span class="keyword">NO</span> <span class="keyword">SQL</span> <span class="operator">|</span> <span class="keyword">READS</span> <span class="keyword">SQL</span> DATA <span class="operator">|</span> <span class="keyword">MODIFIES</span> <span class="keyword">SQL</span> DATA]</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    函数体;</span><br><span class="line">    <span class="keyword">RETURN</span> 返回值;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- DETERMINISTIC：函数结果是确定的，并且不会改变输入参数的值。</span></span><br><span class="line"><span class="comment">-- NO SQL：函数不会执行任何 SQL 语句。</span></span><br><span class="line"><span class="comment">-- READS SQL DATA：函数只读取数据库中的数据，不会修改数据。</span></span><br><span class="line"><span class="comment">-- MODIFIES SQL DATA：函数会修改数据库中的数据。 </span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> fun_sum(num <span class="type">INT</span>) <span class="keyword">RETURNS</span> <span class="type">INT</span> <span class="keyword">DETERMINISTIC</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> res <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">    WHILE num <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">        DO</span><br><span class="line">            <span class="keyword">SET</span> res :<span class="operator">=</span> res <span class="operator">+</span> num;</span><br><span class="line">            <span class="keyword">SET</span> num :<span class="operator">=</span> num <span class="operator">-</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">END</span> WHILE;</span><br><span class="line">    <span class="keyword">RETURN</span> res;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> fun_sum(<span class="number">100</span>);</span><br></pre></td></tr></table></figure>

<h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2><p>触发器是数据库中的特殊类型函数，当满足触发条件时，触发器会自动执行。</p>
<h3 id="使用触发器"><a href="#使用触发器" class="headerlink" title="使用触发器"></a>使用触发器</h3><ol>
<li><p>创建触发器</p>
<blockquote>
<p>CREATE TRIGGER 触发器名 [BEFORE | AFTER] [INSERT | UPDATE | DELETE] ON 表名 FOR EACH ROW BEGIN 触发器体; END;</p>
</blockquote>
</li>
<li><p>查看触发器</p>
<blockquote>
<p>SHOW TRIGGERS;</p>
</blockquote>
</li>
<li><p>删除触发器</p>
<blockquote>
<p>DROP TRIGGER [表名.]触发器名;</p>
</blockquote>
</li>
</ol>
<h3 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h3><p>创建 user_log 表，记录用户操作日志。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建 user_log 表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> user_logs</span><br><span class="line">(</span><br><span class="line">    id               <span class="type">INT</span>(<span class="number">11</span>)     <span class="keyword">NOT NULL</span> AUTO_INCREMENT <span class="keyword">PRIMARY KEY</span> COMMENT <span class="string">&#x27;ID&#x27;</span>,</span><br><span class="line">    operation_type   <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;操作类型&#x27;</span>,</span><br><span class="line">    operation_time   DATETIME    <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;操作时间&#x27;</span>,</span><br><span class="line">    operation_id     <span class="type">INT</span>(<span class="number">11</span>)     <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;操作ID&#x27;</span>,</span><br><span class="line">    operation_params <span class="type">VARCHAR</span>(<span class="number">512</span>) COMMENT <span class="string">&#x27;操作参数&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建触发器</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> insert_trigger</span><br><span class="line">    BEFORE <span class="keyword">INSERT</span></span><br><span class="line">    <span class="keyword">ON</span> tb_user</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">INSERT INTO</span> user_logs(operation_type, operation_time, operation_id, operation_params)</span><br><span class="line">    <span class="keyword">VALUES</span> (<span class="string">&#x27;INSERT&#x27;</span>,</span><br><span class="line">            <span class="built_in">CURRENT_TIME</span>,</span><br><span class="line">            new.id,</span><br><span class="line">            CONCAT(new.id, new.name, new.phone, new.email, new.profession, new.age, new.gender, new.status,</span><br><span class="line">                   new.create_time));</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看触发器</span></span><br><span class="line"><span class="keyword">SHOW</span> TRIGGERS;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除触发器</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> insert_trigger;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试触发器</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> tb_user(name, phone, email, profession, age, gender, status, create_time)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;哪吒&#x27;</span>, <span class="number">17799990025</span>, <span class="string">&#x27;nezha666@sina.com&#x27;</span>, <span class="string">&#x27;计算机科学&#x27;</span>, <span class="number">22</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;2025-11-26 19:32:30&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看日志表</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> user_logs;</span><br><span class="line"><span class="comment">-- 1,INSERT,2025-12-08 19:42:50,0,0哪吒17799990025nezha666@sina.com计算机科学22202025-11-26 19:32:30</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- UPDATE</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> update_trigger</span><br><span class="line">    BEFORE <span class="keyword">UPDATE</span></span><br><span class="line">    <span class="keyword">ON</span> tb_user</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">INSERT INTO</span> user_logs(operation_type, operation_time, operation_id, operation_params)</span><br><span class="line">    <span class="keyword">VALUES</span> (<span class="string">&#x27;UPDATE&#x27;</span>,</span><br><span class="line">            <span class="built_in">CURRENT_TIME</span>,</span><br><span class="line">            new.id,</span><br><span class="line">            CONCAT(old.id, old.name, old.phone, old.email, old.profession, old.age, old.gender, old.status,</span><br><span class="line">                   old.create_time, new.id, new.name, new.phone, new.email, new.profession, new.age, new.gender,</span><br><span class="line">                   new.status,</span><br><span class="line">                   new.create_time));</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> tb_user <span class="keyword">SET</span> profession <span class="operator">=</span> <span class="string">&#x27;软件工程&#x27;</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">27</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 影响了两条数据，所以触发器会执行两次</span></span><br><span class="line"><span class="keyword">UPDATE</span> tb_user <span class="keyword">SET</span> profession <span class="operator">=</span> <span class="string">&#x27;化工&#x27;</span> <span class="keyword">WHERE</span> id <span class="operator">&lt;</span> <span class="number">3</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- DELETE</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> delete_trigger</span><br><span class="line">    BEFORE <span class="keyword">DELETE</span></span><br><span class="line">    <span class="keyword">ON</span> tb_user</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">INSERT INTO</span> user_logs(operation_type, operation_time, operation_id, operation_params)</span><br><span class="line">    <span class="keyword">VALUES</span> (<span class="string">&#x27;DELETE&#x27;</span>,</span><br><span class="line">            <span class="built_in">CURRENT_TIME</span>,</span><br><span class="line">            old.id,</span><br><span class="line">            CONCAT(old.id, old.name, old.phone, old.email, old.profession, old.age, old.gender, old.status,</span><br><span class="line">                   old.create_time));</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> tb_user</span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">27</span>;</span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol>
<li>视图(VIEW)：是数据库中的虚拟表，它可以对数据库中的数据进行查询和操作。</li>
<li>存储过程(PROCEDURE)：事先定义并编写好的SQL语句，可以重复使用。</li>
<li>存储函数(FUNCTION)：同存储过程一样，事先定义并编写好的SQL语句，可以重复使用。</li>
<li>触发器(TRIGGER)：当满足触发条件时，触发器会自动执行。</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://codedog1024.github.io">Code Dog</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://codedog1024.github.io/2025/11/25/MySQL10/">https://codedog1024.github.io/2025/11/25/MySQL10/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://codedog1024.github.io" target="_blank">代码狗的小屋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><div class="post-share"><div class="social-share" data-image="/img/13.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/24/MySQL9/" title="MySQL SQL 优化"><img class="cover" src="/img/01.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">MySQL SQL 优化</div></div><div class="info-2"><div class="info-item-1">插入优化普通插入插入一条数据 12INSERT INTO tb_user(name, phone, email, profession, age, gender, status, create_time)VALUES (&#x27;吕布&#x27;, 17799990000, &#x27;lvbu666@163,com&#x27;, &#x27;软件工程&#x27;, 23, &#x27;1&#x27;, &#x27;6&#x27;, &#x27;2001-02-02 00:00:00&#x27;);  批量插入当需要插入多条数据时，不建议使用多个插入语句，而是使用批量插入语句，将多个数据放在一个 INSERT 语句中。 但是尽管批量插入可以插入多条数据，但是不建议超过 1000 条，若超过 1000 条数据，可以将数据以 1000 条为一组分批插入。 12345-- 不建议超过 1000 条INSERT INTO tb_user(name, phone, email, profession, age, gender, status, create_time)VALUES...</div></div></div></a><a class="pagination-related" href="/2025/12/08/MySQL11/" title="MySQL 锁"><img class="cover" src="/img/07.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">MySQL 锁</div></div><div class="info-2"><div class="info-item-1">锁介绍锁是数据库管理系统提供的一种机制，用于控制多个用户对数据库的访问。锁的种类很多，如表锁、行锁、索引锁等。锁的级别也很多，如共享锁、排他锁等。锁的级别会影响锁的等待时间，因此需要根据实际需求选择合适的锁级别。 分类按照锁的颗粒度：  全局锁：锁定整个数据库，对数据库的所有操作都需要等待。 表锁：锁定一个表，对表中的所有操作都需要等待。 行锁：锁定一行数据，对一行数据进行操作时，其他线程不能对同一行数据进行操作。  全局锁全局锁是数据库管理系统提供的一种锁，用于锁定整个数据库，对数据库的所有操作都需要等待。  添加全局锁：  FLUSH TABLES WITH READ LOCK;   释放全局锁：  UNLOCK TABLES;    123-- 会话 1mysql&gt; FLUSH TABLES WITH READ LOCK;Query OK, 0 rows affected (0.01 sec)  1234567891011121314151617181920212223242526272829303132333435363738-- 会话 2--...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/10/29/MySQL1/" title="MySQL 概述"><img class="cover" src="/img/07.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-29</div><div class="info-item-2">MySQL 概述</div></div><div class="info-2"><div class="info-item-1">概述数据库：数据库就是一个仓库，将数据进行有组织的存储管理。 MySQL: 是一个关系型数据库管理系统（Relational Database Management System，RDBMS），MySQL 并不是数据库。 SQL：SQL是Structured Query Language的缩写，是一种数据库查询和程序设计语言。我们需要通过编写 SQL 语句来操作数据库。 数据库分类   数据库 类型    Oracle 关系型数据库   MySQL 关系型数据库   SQL Server 关系型数据库   PostgreSQL 关系型数据库   IBM DB2 关系型数据库   SQLite 关系型数据库   MongoDB 非关系型数据库   Microsoft Azure SQL Database 关系型数据库   Hive 关系型数据库   下载安装 MySQL社区版 下载地址 启动、停止 启动命令：net start 服务名 停止命令：net stop 服务名  连接 使用 MySQL 提供的命令行工具 使用 windows 终端，执行 MySQL [-h...</div></div></div></a><a class="pagination-related" href="/2025/10/29/MySQL2/" title="MySQL SQL"><img class="cover" src="/img/08.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-29</div><div class="info-item-2">MySQL SQL</div></div><div class="info-2"><div class="info-item-1">SQL 通用语法 SQL 语句可以单行或多行编写，以分号结尾。 SQL 中应使用空格来格式化语句，提高可读性。 SQL 语句大小写不敏感，但建议使用大写。 注释： 单行注释：--、# 多行注释：/* */    SQL 分类   分类 全称 描述    DDL Data Definition Language 数据定义语言，用于定义数据库对象，如表、索引、视图、存储过程、函数等   DML Data Manipulation Language 数据操作语言，用于对数据库中的数据进行增删改   DQL Data Query Language 数据查询语言，用于查询数据库中的数据   DCL Data Control Language 数据控制语言，用于控制数据库的访问权限   DDL操作数据库   功能 SQL 语法 描述    查询 SHOW DATABASES; 查询全部数据库   查询 SELECT DATABASE(); 查询当前数据库   创建 CREATE DATABASE [IF NOT EXISTS] 数据库名 [DEFAULT CHARACTER SET...</div></div></div></a><a class="pagination-related" href="/2025/11/06/MySQL4/" title="MySQL 约束"><img class="cover" src="/img/05.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-06</div><div class="info-item-2">MySQL 约束</div></div><div class="info-2"><div class="info-item-1">约束约束：作用在表中的字段上，保证字段的数据满足要求，用于保证数据的正确型、有效性、安全性。 分类   约束 作用 关键字    主键 该值必须唯一、不重复、不能为 NULL PRIMARY KEY   外键 该值必须在指定表中存在 FOREIGN KEY   唯一 该值必须唯一、不重复 UNIQUE   非空 该值不能为空 NOT NULL   默认值 若为指定该值，则使用默认值 DEFAULT   检查 检查字段的值 CHECK   约束代码示例123456789101112CREATE TABLE users (    -- 主键，并且自增    id INT PRIMARY KEY AUTO_INCREMENT COMMENT &#x27;ID&#x27;,    -- 唯一，并且不能为空    name VARCHAR(10) NOT NULL UNIQUE COMMENT &#x27;姓名&#x27;,    -- 检查，年龄必须大于 0 且小于 120    age INT CHECK ( age &gt; 0 AND age &lt; 120) COMMENT...</div></div></div></a><a class="pagination-related" href="/2025/11/07/MySQL5/" title="MySQL 多表查询"><img class="cover" src="/img/10.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-07</div><div class="info-item-2">MySQL 多表查询</div></div><div class="info-2"><div class="info-item-1">多表关系在实际开发中，每个表之间都存在一些关系，基本上分为三种：一对一、一对多(多对一)、多对多。 一对一一对一关系，比如：学生表和档案表，对于学生来说，一个学生只能拥有一份档案，而档案只能属于一个学生，这就是一对一。 12345678910111213CREATE TABLE student (    id   INT PRIMARY KEY AUTO_INCREMENT COMMENT &#x27;ID&#x27;,    name VARCHAR(10) UNIQUE NOT NULL COMMENT &#x27;姓名&#x27;) COMMENT &#x27;学生表&#x27;;CREATE TABLE profile (    id   INT PRIMARY KEY AUTO_INCREMENT COMMENT &#x27;ID&#x27;,    phone CHAR(11) UNIQUE COMMENT &#x27;电话号&#x27;,    address VARCHAR(100) COMMENT &#x27;家庭住址&#x27;,    --...</div></div></div></a><a class="pagination-related" href="/2025/11/06/MySQL3/" title="MySQL 函数"><img class="cover" src="/img/13.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-06</div><div class="info-item-2">MySQL 函数</div></div><div class="info-2"><div class="info-item-1">函数函数是一段已经被编写好，可以直接使用的代码片段。MySQL 中内置了很多的函数，我们可以使用这些函数来完成一些简单的任务。 字符串函数常用字符串函数   函数 描述    CONCAT(str1, str2, …) 连接字符串   LOWER(str) 将字符串转换为小写   UPPER(str) 将字符串转换为大写   LPAD(str, len, pad_str) 左填充字符串   RPAD(str, len, pad_str) 右填充字符串   TRIM(str) 去掉字符串两侧的空格   SUBSTRING(str, start, len) 截取字符串   REPLACE(str, old_str, new_str) 替换字符串   LENGTH(str) 返回字符串的长度   LOCATE(substr, str) 返回子字符串在字符串中的位置   INSTR(str,...</div></div></div></a><a class="pagination-related" href="/2025/11/09/MySQL7/" title="MySQL 存储引擎"><img class="cover" src="/img/07.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-09</div><div class="info-item-2">MySQL 存储引擎</div></div><div class="info-2"><div class="info-item-1">MySQL 体系结构图 客户端连接器：Native C API、JDBC、ODBC、.NET、PHP、Python、Ruby、Cobol 等 MySQL 服务端： 连接层：连接池 服务层：SQL 接口、解析器、查询优化器、缓存 引擎层：可插拔存储引擎 存储层：数据文件、索引文件、数据结构、数据结构描述文件    存储引擎简介存储引擎是 MySQL 数据库管理系统中的核心部分，负责处理数据存储和检索。存储引擎提供了一种机制，将数据存储在数据库管理系统中，并允许用户使用各种查询语句来检索数据。存储引擎是基于表的，而不是库，所以同一个库中的不同表可以有不同的存储引擎。  查看数据库支持的存储引擎  SHOW ENGINES;   设置存储引擎  CREATE TABLE table_name (……) ENGINE&#x3D;[存储引擎名];    123456789101112131415161718192021-- 查看建表语句-- ENGINE=InnoDB 默认存储引擎为 InnoDBSHOW CREATE TABLE account;--...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Code Dog</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">1.</span> <span class="toc-text">视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">视图介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.</span> <span class="toc-text">视图基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E9%80%89%E9%A1%B9"><span class="toc-number">1.3.</span> <span class="toc-text">检查选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%8F%8A%E4%BD%9C%E7%94%A8"><span class="toc-number">1.4.</span> <span class="toc-text">更新及作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E6%A1%88%E4%BE%8B"><span class="toc-number">1.5.</span> <span class="toc-text">视图案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.1.</span> <span class="toc-text">存储过程介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%89%B9%E7%82%B9"><span class="toc-number">2.2.</span> <span class="toc-text">存储过程特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">2.3.</span> <span class="toc-text">存储过程基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">2.4.</span> <span class="toc-text">变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">2.5.</span> <span class="toc-text">系统变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F"><span class="toc-number">2.6.</span> <span class="toc-text">用户变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="toc-number">2.7.</span> <span class="toc-text">局部变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IF"><span class="toc-number">2.8.</span> <span class="toc-text">IF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%BC%A0%E5%8F%82"><span class="toc-number">2.9.</span> <span class="toc-text">存储过程传参</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CASE"><span class="toc-number">2.10.</span> <span class="toc-text">CASE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WHILE"><span class="toc-number">2.11.</span> <span class="toc-text">WHILE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#REPEAT"><span class="toc-number">2.12.</span> <span class="toc-text">REPEAT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LOOP"><span class="toc-number">2.13.</span> <span class="toc-text">LOOP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CURSOR"><span class="toc-number">2.14.</span> <span class="toc-text">CURSOR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-number">2.15.</span> <span class="toc-text">条件处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text">存储函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">4.</span> <span class="toc-text">触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">4.1.</span> <span class="toc-text">使用触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-number">4.2.</span> <span class="toc-text">练习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/12/16/JDBC03/" title="JDBC PreparedStatement"><img src="/img/09.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JDBC PreparedStatement"/></a><div class="content"><a class="title" href="/2025/12/16/JDBC03/" title="JDBC PreparedStatement">JDBC PreparedStatement</a><time datetime="2025-12-16T12:48:36.000Z" title="发表于 2025-12-16 20:48:36">2025-12-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/16/JDBC02/" title="JDBC 获取数据库连接"><img src="/img/12.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JDBC 获取数据库连接"/></a><div class="content"><a class="title" href="/2025/12/16/JDBC02/" title="JDBC 获取数据库连接">JDBC 获取数据库连接</a><time datetime="2025-12-16T11:37:46.000Z" title="发表于 2025-12-16 19:37:46">2025-12-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/15/JDBC01/" title="JDBC 概述"><img src="/img/10.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JDBC 概述"/></a><div class="content"><a class="title" href="/2025/12/15/JDBC01/" title="JDBC 概述">JDBC 概述</a><time datetime="2025-12-15T12:54:15.000Z" title="发表于 2025-12-15 20:54:15">2025-12-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/15/MySQL16/" title="MySQL 分库分表"><img src="/img/05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL 分库分表"/></a><div class="content"><a class="title" href="/2025/12/15/MySQL16/" title="MySQL 分库分表">MySQL 分库分表</a><time datetime="2025-12-15T04:15:58.000Z" title="发表于 2025-12-15 12:15:58">2025-12-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/14/MySQL15/" title="MySQL 主从复制"><img src="/img/07.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL 主从复制"/></a><div class="content"><a class="title" href="/2025/12/14/MySQL15/" title="MySQL 主从复制">MySQL 主从复制</a><time datetime="2025-12-14T14:29:43.000Z" title="发表于 2025-12-14 22:29:43">2025-12-14</time></div></div></div></div></div></div></main><footer id="footer" style="background: ture;"><div id="footer-wrap"><div class="copyright">&copy;2025 By Code Dog</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      false 
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>